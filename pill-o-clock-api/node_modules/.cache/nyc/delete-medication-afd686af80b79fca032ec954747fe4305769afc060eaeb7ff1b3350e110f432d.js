function cov_105q3ccnhv(){var path="/Users/Au/bootcamp/collab/skylab-bootcamp-202001/staff/aurora-perez/pill-o-clock/pill-o-clock-api/logic/delete-medication.js";var hash="40cd7a0f47f8a14d430cdb86bc8a0ed13acdde8c";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/Au/bootcamp/collab/skylab-bootcamp-202001/staff/aurora-perez/pill-o-clock/pill-o-clock-api/logic/delete-medication.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:50}},"1":{start:{line:2,column:35},end:{line:2,column:63}},"2":{start:{line:3,column:43},end:{line:3,column:73}},"3":{start:{line:5,column:0},end:{line:24,column:1}},"4":{start:{line:6,column:4},end:{line:6,column:29}},"5":{start:{line:7,column:4},end:{line:7,column:41}},"6":{start:{line:11,column:4},end:{line:23,column:24}},"7":{start:{line:13,column:12},end:{line:13,column:86}},"8":{start:{line:13,column:23},end:{line:13,column:86}},"9":{start:{line:14,column:12},end:{line:14,column:78}},"10":{start:{line:14,column:23},end:{line:14,column:78}},"11":{start:{line:15,column:12},end:{line:15,column:24}},"12":{start:{line:17,column:12},end:{line:19,column:14}},"13":{start:{line:18,column:16},end:{line:18,column:75}},"14":{start:{line:18,column:48},end:{line:18,column:75}},"15":{start:{line:21,column:12},end:{line:21,column:31}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:5,column:17},end:{line:5,column:18}},loc:{start:{line:5,column:35},end:{line:24,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:12,column:14},end:{line:12,column:15}},loc:{start:{line:12,column:32},end:{line:22,column:9}},line:12},"2":{name:"(anonymous_2)",decl:{start:{line:17,column:37},end:{line:17,column:38}},loc:{start:{line:17,column:45},end:{line:19,column:13}},line:17},"3":{name:"(anonymous_3)",decl:{start:{line:23,column:14},end:{line:23,column:15}},loc:{start:{line:23,column:20},end:{line:23,column:23}},line:23}},branchMap:{"0":{loc:{start:{line:13,column:12},end:{line:13,column:86}},type:"if",locations:[{start:{line:13,column:12},end:{line:13,column:86}},{start:{line:13,column:12},end:{line:13,column:86}}],line:13},"1":{loc:{start:{line:14,column:12},end:{line:14,column:78}},type:"if",locations:[{start:{line:14,column:12},end:{line:14,column:78}},{start:{line:14,column:12},end:{line:14,column:78}}],line:14},"2":{loc:{start:{line:18,column:16},end:{line:18,column:75}},type:"if",locations:[{start:{line:18,column:16},end:{line:18,column:75}},{start:{line:18,column:16},end:{line:18,column:75}}],line:18}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"40cd7a0f47f8a14d430cdb86bc8a0ed13acdde8c"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_105q3ccnhv=function(){return actualCoverage;};return actualCoverage;}cov_105q3ccnhv();const{validate}=(cov_105q3ccnhv().s[0]++,require('pill-o-clock-utils'));const{models:{User,Drug}}=(cov_105q3ccnhv().s[1]++,require('pill-o-clock-data'));const{NotFoundError,NotAllowedError}=(cov_105q3ccnhv().s[2]++,require('pill-o-clock-errors'));cov_105q3ccnhv().s[3]++;module.exports=(id,drugName)=>{cov_105q3ccnhv().f[0]++;cov_105q3ccnhv().s[4]++;validate.string(id,'id');cov_105q3ccnhv().s[5]++;validate.string(drugName,'drugName');let _user;cov_105q3ccnhv().s[6]++;return Promise.all([User.findById(id),Drug.findOne({drugName})]).then(([user,drug])=>{cov_105q3ccnhv().f[1]++;cov_105q3ccnhv().s[7]++;if(!drug){cov_105q3ccnhv().b[0][0]++;cov_105q3ccnhv().s[8]++;throw new NotFoundError(`drug with name ${drugName} not found`);}else{cov_105q3ccnhv().b[0][1]++;}cov_105q3ccnhv().s[9]++;if(!user){cov_105q3ccnhv().b[1][0]++;cov_105q3ccnhv().s[10]++;throw new NotFoundError(`user with id ${id} not found`);}else{cov_105q3ccnhv().b[1][1]++;}cov_105q3ccnhv().s[11]++;_user=user;cov_105q3ccnhv().s[12]++;_user.medication.forEach(drug=>{cov_105q3ccnhv().f[2]++;cov_105q3ccnhv().s[13]++;if(drug.drugName===drugName){cov_105q3ccnhv().b[2][0]++;cov_105q3ccnhv().s[14]++;_user.medication.pull(drug);}else{cov_105q3ccnhv().b[2][1]++;}});cov_105q3ccnhv().s[15]++;return _user.save();}).then(()=>{cov_105q3ccnhv().f[3]++;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlbGV0ZS1tZWRpY2F0aW9uLmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlIiwicmVxdWlyZSIsIm1vZGVscyIsIlVzZXIiLCJEcnVnIiwiTm90Rm91bmRFcnJvciIsIk5vdEFsbG93ZWRFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJpZCIsImRydWdOYW1lIiwic3RyaW5nIiwiX3VzZXIiLCJQcm9taXNlIiwiYWxsIiwiZmluZEJ5SWQiLCJmaW5kT25lIiwidGhlbiIsInVzZXIiLCJkcnVnIiwibWVkaWNhdGlvbiIsImZvckVhY2giLCJwdWxsIiwic2F2ZSJdLCJtYXBwaW5ncyI6Im0rRkFBQSxLQUFNLENBQUVBLFFBQUYsMkJBQWVDLE9BQU8sQ0FBQyxvQkFBRCxDQUF0QixDQUFOLENBQ0EsS0FBTSxDQUFFQyxNQUFNLENBQUUsQ0FBRUMsSUFBRixDQUFRQyxJQUFSLENBQVYsMkJBQTZCSCxPQUFPLENBQUMsbUJBQUQsQ0FBcEMsQ0FBTixDQUNBLEtBQU0sQ0FBRUksYUFBRixDQUFpQkMsZUFBakIsMkJBQXFDTCxPQUFPLENBQUMscUJBQUQsQ0FBNUMsQ0FBTixDLHdCQUVBTSxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsQ0FBQ0MsRUFBRCxDQUFLQyxRQUFMLEdBQWtCLGlEQUMvQlYsUUFBUSxDQUFDVyxNQUFULENBQWdCRixFQUFoQixDQUFvQixJQUFwQixFQUQrQix3QkFFL0JULFFBQVEsQ0FBQ1csTUFBVCxDQUFnQkQsUUFBaEIsQ0FBMEIsVUFBMUIsRUFFQSxHQUFJRSxDQUFBQSxLQUFKLENBSitCLHdCQU0vQixNQUFPQyxDQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxDQUFDWCxJQUFJLENBQUNZLFFBQUwsQ0FBY04sRUFBZCxDQUFELENBQW9CTCxJQUFJLENBQUNZLE9BQUwsQ0FBYSxDQUFDTixRQUFELENBQWIsQ0FBcEIsQ0FBWixFQUNGTyxJQURFLENBQ0csQ0FBQyxDQUFDQyxJQUFELENBQU9DLElBQVAsQ0FBRCxHQUFrQixpREFDcEIsR0FBSSxDQUFDQSxJQUFMLENBQVcseURBQU0sSUFBSWQsQ0FBQUEsYUFBSixDQUFtQixrQkFBaUJLLFFBQVMsWUFBN0MsQ0FBTixDQUErRCxDQUExRSxpQ0FEb0Isd0JBRXBCLEdBQUksQ0FBQ1EsSUFBTCxDQUFXLDBEQUFNLElBQUliLENBQUFBLGFBQUosQ0FBbUIsZ0JBQWVJLEVBQUcsWUFBckMsQ0FBTixDQUF1RCxDQUFsRSxpQ0FGb0IseUJBR3BCRyxLQUFLLENBQUdNLElBQVIsQ0FIb0IseUJBS3BCTixLQUFLLENBQUNRLFVBQU4sQ0FBaUJDLE9BQWpCLENBQXlCRixJQUFJLEVBQUksa0RBQzdCLEdBQUlBLElBQUksQ0FBQ1QsUUFBTCxHQUFrQkEsUUFBdEIsQ0FBZ0MscURBQUFFLEtBQUssQ0FBQ1EsVUFBTixDQUFpQkUsSUFBakIsQ0FBc0JILElBQXRCLEVBQTJCLENBQTNELGlDQUNILENBRkQsRUFMb0IseUJBU3BCLE1BQU9QLENBQUFBLEtBQUssQ0FBQ1csSUFBTixFQUFQLENBQ0gsQ0FYRSxFQVlGTixJQVpFLENBWUcsSUFBTSx5QkFBRyxDQVpaLENBQVAsQ0FhSCxDQW5CRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgdmFsaWRhdGUgfSA9IHJlcXVpcmUoJ3BpbGwtby1jbG9jay11dGlscycpXG5jb25zdCB7IG1vZGVsczogeyBVc2VyLCBEcnVnIH0gfSA9IHJlcXVpcmUoJ3BpbGwtby1jbG9jay1kYXRhJylcbmNvbnN0IHsgTm90Rm91bmRFcnJvciwgTm90QWxsb3dlZEVycm9yIH0gPSByZXF1aXJlKCdwaWxsLW8tY2xvY2stZXJyb3JzJylcblxubW9kdWxlLmV4cG9ydHMgPSAoaWQsIGRydWdOYW1lKSA9PiB7XG4gICAgdmFsaWRhdGUuc3RyaW5nKGlkLCAnaWQnKVxuICAgIHZhbGlkYXRlLnN0cmluZyhkcnVnTmFtZSwgJ2RydWdOYW1lJylcbiAgICBcbiAgICBsZXQgX3VzZXJcblxuICAgIHJldHVybiBQcm9taXNlLmFsbChbVXNlci5maW5kQnlJZChpZCksIERydWcuZmluZE9uZSh7ZHJ1Z05hbWV9KSBdKVxuICAgICAgICAudGhlbigoW3VzZXIsIGRydWddKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWRydWcpIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKGBkcnVnIHdpdGggbmFtZSAke2RydWdOYW1lfSBub3QgZm91bmRgKVxuICAgICAgICAgICAgaWYgKCF1c2VyKSB0aHJvdyBuZXcgTm90Rm91bmRFcnJvcihgdXNlciB3aXRoIGlkICR7aWR9IG5vdCBmb3VuZGApXG4gICAgICAgICAgICBfdXNlciA9IHVzZXJcblxuICAgICAgICAgICAgX3VzZXIubWVkaWNhdGlvbi5mb3JFYWNoKGRydWcgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkcnVnLmRydWdOYW1lID09PSBkcnVnTmFtZSkgX3VzZXIubWVkaWNhdGlvbi5wdWxsKGRydWcpXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICByZXR1cm4gX3VzZXIuc2F2ZSgpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKCgpID0+IHsgfSlcbn0iXX0=
function cov_105q3ccnhv(){var path="/Users/Au/bootcamp/collab/skylab-bootcamp-202001/staff/aurora-perez/pill-o-clock/pill-o-clock-api/logic/delete-medication.js";var hash="7353ccc31329bca378b68e22d0400450f7de87f5";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/Au/bootcamp/collab/skylab-bootcamp-202001/staff/aurora-perez/pill-o-clock/pill-o-clock-api/logic/delete-medication.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:50}},"1":{start:{line:2,column:35},end:{line:2,column:63}},"2":{start:{line:3,column:43},end:{line:3,column:73}},"3":{start:{line:17,column:0},end:{line:36,column:1}},"4":{start:{line:18,column:4},end:{line:18,column:29}},"5":{start:{line:19,column:4},end:{line:19,column:41}},"6":{start:{line:23,column:4},end:{line:35,column:24}},"7":{start:{line:25,column:12},end:{line:25,column:86}},"8":{start:{line:25,column:23},end:{line:25,column:86}},"9":{start:{line:26,column:12},end:{line:26,column:78}},"10":{start:{line:26,column:23},end:{line:26,column:78}},"11":{start:{line:27,column:12},end:{line:27,column:24}},"12":{start:{line:29,column:12},end:{line:31,column:14}},"13":{start:{line:30,column:16},end:{line:30,column:75}},"14":{start:{line:30,column:48},end:{line:30,column:75}},"15":{start:{line:33,column:12},end:{line:33,column:31}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:17},end:{line:17,column:18}},loc:{start:{line:17,column:35},end:{line:36,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:24,column:14},end:{line:24,column:15}},loc:{start:{line:24,column:32},end:{line:34,column:9}},line:24},"2":{name:"(anonymous_2)",decl:{start:{line:29,column:37},end:{line:29,column:38}},loc:{start:{line:29,column:45},end:{line:31,column:13}},line:29},"3":{name:"(anonymous_3)",decl:{start:{line:35,column:14},end:{line:35,column:15}},loc:{start:{line:35,column:20},end:{line:35,column:23}},line:35}},branchMap:{"0":{loc:{start:{line:25,column:12},end:{line:25,column:86}},type:"if",locations:[{start:{line:25,column:12},end:{line:25,column:86}},{start:{line:25,column:12},end:{line:25,column:86}}],line:25},"1":{loc:{start:{line:26,column:12},end:{line:26,column:78}},type:"if",locations:[{start:{line:26,column:12},end:{line:26,column:78}},{start:{line:26,column:12},end:{line:26,column:78}}],line:26},"2":{loc:{start:{line:30,column:16},end:{line:30,column:75}},type:"if",locations:[{start:{line:30,column:16},end:{line:30,column:75}},{start:{line:30,column:16},end:{line:30,column:75}}],line:30}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"7353ccc31329bca378b68e22d0400450f7de87f5"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_105q3ccnhv=function(){return actualCoverage;};return actualCoverage;}cov_105q3ccnhv();const{validate}=(cov_105q3ccnhv().s[0]++,require('pill-o-clock-utils'));const{models:{User,Drug}}=(cov_105q3ccnhv().s[1]++,require('pill-o-clock-data'));const{NotFoundError,NotAllowedError}=(cov_105q3ccnhv().s[2]++,require('pill-o-clock-errors'));/**
 * Delete medication from the user's medication
 * 
 * @param {string} id user's unique id
 * 
 * @param {string} drugName drug's name
 *
 * @returns {Promise<undefined>} an empty Promise on a successful deletion
 * 
 * @throws {NotFoundError} if the user or the drug does not exist
 */cov_105q3ccnhv().s[3]++;module.exports=(id,drugName)=>{cov_105q3ccnhv().f[0]++;cov_105q3ccnhv().s[4]++;validate.string(id,'id');cov_105q3ccnhv().s[5]++;validate.string(drugName,'drugName');let _user;cov_105q3ccnhv().s[6]++;return Promise.all([User.findById(id),Drug.findOne({drugName})]).then(([user,drug])=>{cov_105q3ccnhv().f[1]++;cov_105q3ccnhv().s[7]++;if(!drug){cov_105q3ccnhv().b[0][0]++;cov_105q3ccnhv().s[8]++;throw new NotFoundError(`drug with name ${drugName} not found`);}else{cov_105q3ccnhv().b[0][1]++;}cov_105q3ccnhv().s[9]++;if(!user){cov_105q3ccnhv().b[1][0]++;cov_105q3ccnhv().s[10]++;throw new NotFoundError(`user with id ${id} not found`);}else{cov_105q3ccnhv().b[1][1]++;}cov_105q3ccnhv().s[11]++;_user=user;cov_105q3ccnhv().s[12]++;_user.medication.forEach(drug=>{cov_105q3ccnhv().f[2]++;cov_105q3ccnhv().s[13]++;if(drug.drugName===drugName){cov_105q3ccnhv().b[2][0]++;cov_105q3ccnhv().s[14]++;_user.medication.pull(drug);}else{cov_105q3ccnhv().b[2][1]++;}});cov_105q3ccnhv().s[15]++;return _user.save();}).then(()=>{cov_105q3ccnhv().f[3]++;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlbGV0ZS1tZWRpY2F0aW9uLmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlIiwicmVxdWlyZSIsIm1vZGVscyIsIlVzZXIiLCJEcnVnIiwiTm90Rm91bmRFcnJvciIsIk5vdEFsbG93ZWRFcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJpZCIsImRydWdOYW1lIiwic3RyaW5nIiwiX3VzZXIiLCJQcm9taXNlIiwiYWxsIiwiZmluZEJ5SWQiLCJmaW5kT25lIiwidGhlbiIsInVzZXIiLCJkcnVnIiwibWVkaWNhdGlvbiIsImZvckVhY2giLCJwdWxsIiwic2F2ZSJdLCJtYXBwaW5ncyI6IjQrRkFBQSxLQUFNLENBQUVBLFFBQUYsMkJBQWVDLE9BQU8sQ0FBQyxvQkFBRCxDQUF0QixDQUFOLENBQ0EsS0FBTSxDQUFFQyxNQUFNLENBQUUsQ0FBRUMsSUFBRixDQUFRQyxJQUFSLENBQVYsMkJBQTZCSCxPQUFPLENBQUMsbUJBQUQsQ0FBcEMsQ0FBTixDQUNBLEtBQU0sQ0FBRUksYUFBRixDQUFpQkMsZUFBakIsMkJBQXFDTCxPQUFPLENBQUMscUJBQUQsQ0FBNUMsQ0FBTixDQUVBOzs7Ozs7Ozs7OzJCQVlBTSxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsQ0FBQ0MsRUFBRCxDQUFLQyxRQUFMLEdBQWtCLGlEQUMvQlYsUUFBUSxDQUFDVyxNQUFULENBQWdCRixFQUFoQixDQUFvQixJQUFwQixFQUQrQix3QkFFL0JULFFBQVEsQ0FBQ1csTUFBVCxDQUFnQkQsUUFBaEIsQ0FBMEIsVUFBMUIsRUFFQSxHQUFJRSxDQUFBQSxLQUFKLENBSitCLHdCQU0vQixNQUFPQyxDQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxDQUFDWCxJQUFJLENBQUNZLFFBQUwsQ0FBY04sRUFBZCxDQUFELENBQW9CTCxJQUFJLENBQUNZLE9BQUwsQ0FBYSxDQUFDTixRQUFELENBQWIsQ0FBcEIsQ0FBWixFQUNGTyxJQURFLENBQ0csQ0FBQyxDQUFDQyxJQUFELENBQU9DLElBQVAsQ0FBRCxHQUFrQixpREFDcEIsR0FBSSxDQUFDQSxJQUFMLENBQVcseURBQU0sSUFBSWQsQ0FBQUEsYUFBSixDQUFtQixrQkFBaUJLLFFBQVMsWUFBN0MsQ0FBTixDQUErRCxDQUExRSxpQ0FEb0Isd0JBRXBCLEdBQUksQ0FBQ1EsSUFBTCxDQUFXLDBEQUFNLElBQUliLENBQUFBLGFBQUosQ0FBbUIsZ0JBQWVJLEVBQUcsWUFBckMsQ0FBTixDQUF1RCxDQUFsRSxpQ0FGb0IseUJBR3BCRyxLQUFLLENBQUdNLElBQVIsQ0FIb0IseUJBS3BCTixLQUFLLENBQUNRLFVBQU4sQ0FBaUJDLE9BQWpCLENBQXlCRixJQUFJLEVBQUksa0RBQzdCLEdBQUlBLElBQUksQ0FBQ1QsUUFBTCxHQUFrQkEsUUFBdEIsQ0FBZ0MscURBQUFFLEtBQUssQ0FBQ1EsVUFBTixDQUFpQkUsSUFBakIsQ0FBc0JILElBQXRCLEVBQTJCLENBQTNELGlDQUNILENBRkQsRUFMb0IseUJBU3BCLE1BQU9QLENBQUFBLEtBQUssQ0FBQ1csSUFBTixFQUFQLENBQ0gsQ0FYRSxFQVlGTixJQVpFLENBWUcsSUFBTSx5QkFBRyxDQVpaLENBQVAsQ0FhSCxDQW5CRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgdmFsaWRhdGUgfSA9IHJlcXVpcmUoJ3BpbGwtby1jbG9jay11dGlscycpXG5jb25zdCB7IG1vZGVsczogeyBVc2VyLCBEcnVnIH0gfSA9IHJlcXVpcmUoJ3BpbGwtby1jbG9jay1kYXRhJylcbmNvbnN0IHsgTm90Rm91bmRFcnJvciwgTm90QWxsb3dlZEVycm9yIH0gPSByZXF1aXJlKCdwaWxsLW8tY2xvY2stZXJyb3JzJylcblxuLyoqXG4gKiBEZWxldGUgbWVkaWNhdGlvbiBmcm9tIHRoZSB1c2VyJ3MgbWVkaWNhdGlvblxuICogXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgdXNlcidzIHVuaXF1ZSBpZFxuICogXG4gKiBAcGFyYW0ge3N0cmluZ30gZHJ1Z05hbWUgZHJ1ZydzIG5hbWVcbiAqXG4gKiBAcmV0dXJucyB7UHJvbWlzZTx1bmRlZmluZWQ+fSBhbiBlbXB0eSBQcm9taXNlIG9uIGEgc3VjY2Vzc2Z1bCBkZWxldGlvblxuICogXG4gKiBAdGhyb3dzIHtOb3RGb3VuZEVycm9yfSBpZiB0aGUgdXNlciBvciB0aGUgZHJ1ZyBkb2VzIG5vdCBleGlzdFxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gKGlkLCBkcnVnTmFtZSkgPT4ge1xuICAgIHZhbGlkYXRlLnN0cmluZyhpZCwgJ2lkJylcbiAgICB2YWxpZGF0ZS5zdHJpbmcoZHJ1Z05hbWUsICdkcnVnTmFtZScpXG4gICAgXG4gICAgbGV0IF91c2VyXG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1VzZXIuZmluZEJ5SWQoaWQpLCBEcnVnLmZpbmRPbmUoe2RydWdOYW1lfSkgXSlcbiAgICAgICAgLnRoZW4oKFt1c2VyLCBkcnVnXSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFkcnVnKSB0aHJvdyBuZXcgTm90Rm91bmRFcnJvcihgZHJ1ZyB3aXRoIG5hbWUgJHtkcnVnTmFtZX0gbm90IGZvdW5kYClcbiAgICAgICAgICAgIGlmICghdXNlcikgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoYHVzZXIgd2l0aCBpZCAke2lkfSBub3QgZm91bmRgKVxuICAgICAgICAgICAgX3VzZXIgPSB1c2VyXG5cbiAgICAgICAgICAgIF91c2VyLm1lZGljYXRpb24uZm9yRWFjaChkcnVnID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZHJ1Zy5kcnVnTmFtZSA9PT0gZHJ1Z05hbWUpIF91c2VyLm1lZGljYXRpb24ucHVsbChkcnVnKVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgcmV0dXJuIF91c2VyLnNhdmUoKVxuICAgICAgICB9KVxuICAgICAgICAudGhlbigoKSA9PiB7IH0pXG59Il19
function cov_12tm0a6jc3(){var path="/Users/Au/bootcamp/collab/skylab-bootcamp-202001/staff/aurora-perez/pill-o-clock/pill-o-clock-api/logic/register-user.js";var hash="6342aecba6c412ff6735253291f101d18d8d3ab0";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/Au/bootcamp/collab/skylab-bootcamp-202001/staff/aurora-perez/pill-o-clock/pill-o-clock-api/logic/register-user.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:50}},"1":{start:{line:2,column:29},end:{line:2,column:57}},"2":{start:{line:3,column:28},end:{line:3,column:58}},"3":{start:{line:4,column:15},end:{line:4,column:34}},"4":{start:{line:6,column:0},end:{line:30,column:1}},"5":{start:{line:7,column:4},end:{line:7,column:33}},"6":{start:{line:8,column:4},end:{line:8,column:39}},"7":{start:{line:9,column:4},end:{line:9,column:37}},"8":{start:{line:10,column:4},end:{line:10,column:27}},"9":{start:{line:11,column:4},end:{line:11,column:37}},"10":{start:{line:12,column:4},end:{line:12,column:35}},"11":{start:{line:13,column:4},end:{line:13,column:39}},"12":{start:{line:14,column:4},end:{line:14,column:35}},"13":{start:{line:15,column:4},end:{line:15,column:25}},"14":{start:{line:16,column:4},end:{line:16,column:41}},"15":{start:{line:18,column:4},end:{line:29,column:24}},"16":{start:{line:20,column:12},end:{line:20,column:90}},"17":{start:{line:20,column:22},end:{line:20,column:90}},"18":{start:{line:22,column:12},end:{line:22,column:44}},"19":{start:{line:25,column:12},end:{line:25,column:111}},"20":{start:{line:27,column:12},end:{line:27,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:17},end:{line:6,column:18}},loc:{start:{line:6,column:82},end:{line:30,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:14},end:{line:19,column:15}},loc:{start:{line:19,column:22},end:{line:23,column:9}},line:19},"2":{name:"(anonymous_2)",decl:{start:{line:24,column:14},end:{line:24,column:15}},loc:{start:{line:24,column:26},end:{line:28,column:9}},line:24},"3":{name:"(anonymous_3)",decl:{start:{line:29,column:14},end:{line:29,column:15}},loc:{start:{line:29,column:20},end:{line:29,column:23}},line:29}},branchMap:{"0":{loc:{start:{line:20,column:12},end:{line:20,column:90}},type:"if",locations:[{start:{line:20,column:12},end:{line:20,column:90}},{start:{line:20,column:12},end:{line:20,column:90}}],line:20}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6342aecba6c412ff6735253291f101d18d8d3ab0"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_12tm0a6jc3=function(){return actualCoverage;};return actualCoverage;}cov_12tm0a6jc3();const{validate}=(cov_12tm0a6jc3().s[0]++,require('pill-o-clock-utils'));const{models:{User}}=(cov_12tm0a6jc3().s[1]++,require('pill-o-clock-data'));const{NotAllowedError}=(cov_12tm0a6jc3().s[2]++,require('pill-o-clock-errors'));const bcrypt=(cov_12tm0a6jc3().s[3]++,require('bcryptjs'));cov_12tm0a6jc3().s[4]++;module.exports=(name,surname,gender,age,phone,profile,email,password)=>{cov_12tm0a6jc3().f[0]++;cov_12tm0a6jc3().s[5]++;validate.string(name,'name');cov_12tm0a6jc3().s[6]++;validate.string(surname,'surname');cov_12tm0a6jc3().s[7]++;validate.string(gender,'gender');cov_12tm0a6jc3().s[8]++;validate.gender(gender);cov_12tm0a6jc3().s[9]++;validate.type(age,'age',Number);cov_12tm0a6jc3().s[10]++;validate.string(phone,'phone');cov_12tm0a6jc3().s[11]++;validate.string(profile,'profile');cov_12tm0a6jc3().s[12]++;validate.string(email,'email');cov_12tm0a6jc3().s[13]++;validate.email(email);cov_12tm0a6jc3().s[14]++;validate.string(password,'password');cov_12tm0a6jc3().s[15]++;return User.findOne({email}).then(user=>{cov_12tm0a6jc3().f[1]++;cov_12tm0a6jc3().s[16]++;if(user){cov_12tm0a6jc3().b[0][0]++;cov_12tm0a6jc3().s[17]++;throw new NotAllowedError(`user with email ${email} already exists`);}else{cov_12tm0a6jc3().b[0][1]++;}cov_12tm0a6jc3().s[18]++;return bcrypt.hash(password,10);}).then(password=>{cov_12tm0a6jc3().f[2]++;cov_12tm0a6jc3().s[19]++;user=new User({name,surname,gender,age,phone,profile,email,password,created:new Date()});cov_12tm0a6jc3().s[20]++;return user.save();}).then(()=>{cov_12tm0a6jc3().f[3]++;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZ2lzdGVyLXVzZXIuanMiXSwibmFtZXMiOlsidmFsaWRhdGUiLCJyZXF1aXJlIiwibW9kZWxzIiwiVXNlciIsIk5vdEFsbG93ZWRFcnJvciIsImJjcnlwdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJuYW1lIiwic3VybmFtZSIsImdlbmRlciIsImFnZSIsInBob25lIiwicHJvZmlsZSIsImVtYWlsIiwicGFzc3dvcmQiLCJzdHJpbmciLCJ0eXBlIiwiTnVtYmVyIiwiZmluZE9uZSIsInRoZW4iLCJ1c2VyIiwiaGFzaCIsImNyZWF0ZWQiLCJEYXRlIiwic2F2ZSJdLCJtYXBwaW5ncyI6Im0zRkFBQSxLQUFNLENBQUVBLFFBQUYsMkJBQWVDLE9BQU8sQ0FBQyxvQkFBRCxDQUF0QixDQUFOLENBQ0EsS0FBTSxDQUFFQyxNQUFNLENBQUUsQ0FBRUMsSUFBRixDQUFWLDJCQUF1QkYsT0FBTyxDQUFDLG1CQUFELENBQTlCLENBQU4sQ0FDQSxLQUFNLENBQUVHLGVBQUYsMkJBQXNCSCxPQUFPLENBQUMscUJBQUQsQ0FBN0IsQ0FBTixDQUNBLEtBQU1JLENBQUFBLE1BQU0sMEJBQUdKLE9BQU8sQ0FBQyxVQUFELENBQVYsQ0FBWixDLHdCQUVBSyxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsQ0FBQ0MsSUFBRCxDQUFPQyxPQUFQLENBQWdCQyxNQUFoQixDQUF3QkMsR0FBeEIsQ0FBNkJDLEtBQTdCLENBQW9DQyxPQUFwQyxDQUE2Q0MsS0FBN0MsQ0FBb0RDLFFBQXBELEdBQWlFLGlEQUM5RWYsUUFBUSxDQUFDZ0IsTUFBVCxDQUFnQlIsSUFBaEIsQ0FBc0IsTUFBdEIsRUFEOEUsd0JBRTlFUixRQUFRLENBQUNnQixNQUFULENBQWdCUCxPQUFoQixDQUF5QixTQUF6QixFQUY4RSx3QkFHOUVULFFBQVEsQ0FBQ2dCLE1BQVQsQ0FBZ0JOLE1BQWhCLENBQXdCLFFBQXhCLEVBSDhFLHdCQUk5RVYsUUFBUSxDQUFDVSxNQUFULENBQWdCQSxNQUFoQixFQUo4RSx3QkFLOUVWLFFBQVEsQ0FBQ2lCLElBQVQsQ0FBY04sR0FBZCxDQUFtQixLQUFuQixDQUEwQk8sTUFBMUIsRUFMOEUseUJBTTlFbEIsUUFBUSxDQUFDZ0IsTUFBVCxDQUFnQkosS0FBaEIsQ0FBdUIsT0FBdkIsRUFOOEUseUJBTzlFWixRQUFRLENBQUNnQixNQUFULENBQWdCSCxPQUFoQixDQUF5QixTQUF6QixFQVA4RSx5QkFROUViLFFBQVEsQ0FBQ2dCLE1BQVQsQ0FBZ0JGLEtBQWhCLENBQXVCLE9BQXZCLEVBUjhFLHlCQVM5RWQsUUFBUSxDQUFDYyxLQUFULENBQWVBLEtBQWYsRUFUOEUseUJBVTlFZCxRQUFRLENBQUNnQixNQUFULENBQWdCRCxRQUFoQixDQUEwQixVQUExQixFQVY4RSx5QkFZOUUsTUFBT1osQ0FBQUEsSUFBSSxDQUFDZ0IsT0FBTCxDQUFhLENBQUVMLEtBQUYsQ0FBYixFQUNGTSxJQURFLENBQ0dDLElBQUksRUFBSSxrREFDVixHQUFJQSxJQUFKLENBQVUsMERBQU0sSUFBSWpCLENBQUFBLGVBQUosQ0FBcUIsbUJBQWtCVSxLQUFNLGlCQUE3QyxDQUFOLENBQW9FLENBQTlFLGlDQURVLHlCQUdWLE1BQU9ULENBQUFBLE1BQU0sQ0FBQ2lCLElBQVAsQ0FBWVAsUUFBWixDQUFzQixFQUF0QixDQUFQLENBQ0gsQ0FMRSxFQU1GSyxJQU5FLENBTUdMLFFBQVEsRUFBSSxrREFDZE0sSUFBSSxDQUFHLEdBQUlsQixDQUFBQSxJQUFKLENBQVMsQ0FBRUssSUFBRixDQUFRQyxPQUFSLENBQWlCQyxNQUFqQixDQUF5QkMsR0FBekIsQ0FBOEJDLEtBQTlCLENBQXFDQyxPQUFyQyxDQUE4Q0MsS0FBOUMsQ0FBcURDLFFBQXJELENBQStEUSxPQUFPLENBQUUsR0FBSUMsQ0FBQUEsSUFBSixFQUF4RSxDQUFULENBQVAsQ0FEYyx5QkFHZCxNQUFPSCxDQUFBQSxJQUFJLENBQUNJLElBQUwsRUFBUCxDQUNILENBVkUsRUFXRkwsSUFYRSxDQVdHLElBQU0seUJBQUcsQ0FYWixDQUFQLENBWUgsQ0F4QkQiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IHZhbGlkYXRlIH0gPSByZXF1aXJlKCdwaWxsLW8tY2xvY2stdXRpbHMnKVxuY29uc3QgeyBtb2RlbHM6IHsgVXNlciB9IH0gPSByZXF1aXJlKCdwaWxsLW8tY2xvY2stZGF0YScpXG5jb25zdCB7IE5vdEFsbG93ZWRFcnJvciB9ID0gcmVxdWlyZSgncGlsbC1vLWNsb2NrLWVycm9ycycpXG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHRqcycpXG5cbm1vZHVsZS5leHBvcnRzID0gKG5hbWUsIHN1cm5hbWUsIGdlbmRlciwgYWdlLCBwaG9uZSwgcHJvZmlsZSwgZW1haWwsIHBhc3N3b3JkKSA9PiB7XG4gICAgdmFsaWRhdGUuc3RyaW5nKG5hbWUsICduYW1lJylcbiAgICB2YWxpZGF0ZS5zdHJpbmcoc3VybmFtZSwgJ3N1cm5hbWUnKVxuICAgIHZhbGlkYXRlLnN0cmluZyhnZW5kZXIsICdnZW5kZXInKVxuICAgIHZhbGlkYXRlLmdlbmRlcihnZW5kZXIpXG4gICAgdmFsaWRhdGUudHlwZShhZ2UsICdhZ2UnLCBOdW1iZXIpXG4gICAgdmFsaWRhdGUuc3RyaW5nKHBob25lLCAncGhvbmUnKVxuICAgIHZhbGlkYXRlLnN0cmluZyhwcm9maWxlLCAncHJvZmlsZScpXG4gICAgdmFsaWRhdGUuc3RyaW5nKGVtYWlsLCAnZW1haWwnKVxuICAgIHZhbGlkYXRlLmVtYWlsKGVtYWlsKVxuICAgIHZhbGlkYXRlLnN0cmluZyhwYXNzd29yZCwgJ3Bhc3N3b3JkJylcblxuICAgIHJldHVybiBVc2VyLmZpbmRPbmUoeyBlbWFpbCB9KVxuICAgICAgICAudGhlbih1c2VyID0+IHtcbiAgICAgICAgICAgIGlmICh1c2VyKSB0aHJvdyBuZXcgTm90QWxsb3dlZEVycm9yKGB1c2VyIHdpdGggZW1haWwgJHtlbWFpbH0gYWxyZWFkeSBleGlzdHNgKVxuXG4gICAgICAgICAgICByZXR1cm4gYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKVxuICAgICAgICB9KVxuICAgICAgICAudGhlbihwYXNzd29yZCA9PiB7XG4gICAgICAgICAgICB1c2VyID0gbmV3IFVzZXIoeyBuYW1lLCBzdXJuYW1lLCBnZW5kZXIsIGFnZSwgcGhvbmUsIHByb2ZpbGUsIGVtYWlsLCBwYXNzd29yZCwgY3JlYXRlZDogbmV3IERhdGUgfSlcblxuICAgICAgICAgICAgcmV0dXJuIHVzZXIuc2F2ZSgpXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKCgpID0+IHsgfSlcbn0iXX0=